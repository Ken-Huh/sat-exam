{"ast":null,"code":"import _objectSpread from\"/sessions/adoring-focused-sagan/mnt/sat-mock-exam/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useCallback,useRef,useEffect}from'react';/**\n * Custom hook for managing text highlights and annotations in passages.\n * Stores highlights per question, persists across question navigation.\n *\n * Usage:\n *   const { highlights, toolbarState, ... } = useHighlighter(containerRef);\n */export default function useHighlighter(){// Map of questionId -> array of highlight objects\n// Each highlight: { id, text, startOffset, endOffset, color, note }\nconst[allHighlights,setAllHighlights]=useState({});// Toolbar state\nconst[toolbarState,setToolbarState]=useState(null);// { x, y, selectionText, range }\n// Annotation popup state\nconst[annotationPopup,setAnnotationPopup]=useState(null);// { highlightId, questionId, x, y }\n// Ref to the passage container DOM element\nconst passageRef=useRef(null);// Current question ID for tracking\nconst currentQuestionIdRef=useRef(null);/**\n   * Set the current question ID (call when question changes)\n   */const setCurrentQuestion=useCallback(questionId=>{currentQuestionIdRef.current=questionId;setToolbarState(null);setAnnotationPopup(null);},[]);/**\n   * Get highlights for a specific question\n   */const getHighlights=useCallback(questionId=>{return allHighlights[questionId]||[];},[allHighlights]);/**\n   * Handle text selection (mouseup) in the passage\n   */const handleMouseUp=useCallback(e=>{// Small delay to let selection finalize\nsetTimeout(()=>{const selection=window.getSelection();if(!selection||selection.isCollapsed||!selection.toString().trim()){// No selection or empty selection\nsetToolbarState(null);return;}// Make sure selection is within the passage container\nconst container=passageRef.current;if(!container)return;const range=selection.getRangeAt(0);if(!container.contains(range.commonAncestorContainer)){return;}const selectedText=selection.toString().trim();if(selectedText.length<2)return;// Ignore very short selections\n// Position toolbar above the selection\nconst rect=range.getBoundingClientRect();const toolbarX=rect.left+rect.width/2;const toolbarY=rect.top-10;setToolbarState({x:toolbarX,y:toolbarY,selectionText:selectedText,range:range.cloneRange()});},10);},[]);/**\n   * Apply a highlight with the given color\n   */const applyHighlight=useCallback(color=>{var _window$getSelection;if(!toolbarState||!toolbarState.range)return;const questionId=currentQuestionIdRef.current;if(!questionId)return;const container=passageRef.current;if(!container)return;// Calculate text offset within the container\nconst{startOffset,endOffset}=getTextOffsets(container,toolbarState.range);const highlight={id:\"hl_\".concat(Date.now(),\"_\").concat(Math.random().toString(36).substr(2,5)),text:toolbarState.selectionText,startOffset,endOffset,color,note:''};setAllHighlights(prev=>_objectSpread(_objectSpread({},prev),{},{[questionId]:[...(prev[questionId]||[]),highlight]}));// Clear selection\n(_window$getSelection=window.getSelection())===null||_window$getSelection===void 0?void 0:_window$getSelection.removeAllRanges();setToolbarState(null);},[toolbarState]);/**\n   * Remove a highlight\n   */const removeHighlight=useCallback((questionId,highlightId)=>{setAllHighlights(prev=>_objectSpread(_objectSpread({},prev),{},{[questionId]:(prev[questionId]||[]).filter(h=>h.id!==highlightId)}));setAnnotationPopup(null);},[]);/**\n   * Update a highlight's note\n   */const updateNote=useCallback((questionId,highlightId,note)=>{setAllHighlights(prev=>_objectSpread(_objectSpread({},prev),{},{[questionId]:(prev[questionId]||[]).map(h=>h.id===highlightId?_objectSpread(_objectSpread({},h),{},{note}):h)}));},[]);/**\n   * Show annotation popup for a highlight\n   */const showAnnotation=useCallback((highlightId,questionId,x,y)=>{setAnnotationPopup({highlightId,questionId,x,y});},[]);/**\n   * Close annotation popup\n   */const closeAnnotation=useCallback(()=>{setAnnotationPopup(null);},[]);/**\n   * Dismiss toolbar when clicking outside\n   */useEffect(()=>{const handleClickOutside=e=>{// Don't dismiss if clicking on the toolbar itself\nif(e.target.closest('.highlight-toolbar')||e.target.closest('.annotation-popup')){return;}// Small delay to allow highlight click handlers to fire first\nsetTimeout(()=>{if(toolbarState){setToolbarState(null);}},100);};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[toolbarState]);return{passageRef,allHighlights,toolbarState,annotationPopup,setCurrentQuestion,getHighlights,handleMouseUp,applyHighlight,removeHighlight,updateNote,showAnnotation,closeAnnotation};}/**\n * Get the text offset of a Range relative to a container element's textContent.\n * This gives us a position that's independent of the HTML structure.\n */function getTextOffsets(container,range){const treeWalker=document.createTreeWalker(container,NodeFilter.SHOW_TEXT,null,false);let charIndex=0;let startOffset=0;let endOffset=0;let foundStart=false;let foundEnd=false;let node;while(node=treeWalker.nextNode()){if(node===range.startContainer){startOffset=charIndex+range.startOffset;foundStart=true;}if(node===range.endContainer){endOffset=charIndex+range.endOffset;foundEnd=true;break;}charIndex+=node.textContent.length;}if(!foundStart)startOffset=0;if(!foundEnd)endOffset=startOffset;return{startOffset,endOffset};}/**\n * Apply stored highlights to a DOM container.\n * Call this after the passage renders/re-renders.\n *\n * @param {HTMLElement} container - The passage DOM container\n * @param {Array} highlights - Array of highlight objects\n * @param {Function} onHighlightClick - Callback when a highlight is clicked\n */export function applyHighlightsToDOM(container,highlights,onHighlightClick){if(!container||!highlights||highlights.length===0)return;// Sort highlights by startOffset descending so we apply from end to start\n// This prevents offset shifts from affecting earlier highlights\nconst sorted=[...highlights].sort((a,b)=>b.startOffset-a.startOffset);sorted.forEach(highlight=>{try{const range=getTextRange(container,highlight.startOffset,highlight.endOffset);if(!range)return;// Create the highlight mark element\nconst mark=document.createElement('mark');mark.className=\"passage-highlight\".concat(highlight.note?' has-note':'');mark.dataset.color=highlight.color;mark.dataset.highlightId=highlight.id;// Handle click to show annotation\nmark.addEventListener('click',e=>{e.stopPropagation();const rect=mark.getBoundingClientRect();onHighlightClick(highlight.id,rect.left+rect.width/2,rect.bottom+5);});range.surroundContents(mark);}catch(err){// If surroundContents fails (e.g., range spans multiple elements),\n// fall back to a simpler approach\nconsole.warn('Could not apply highlight:',err);}});}/**\n * Create a Range from text offsets within a container.\n */function getTextRange(container,startOffset,endOffset){const treeWalker=document.createTreeWalker(container,NodeFilter.SHOW_TEXT,null,false);let charIndex=0;let startNode=null;let startNodeOffset=0;let endNode=null;let endNodeOffset=0;let node;while(node=treeWalker.nextNode()){const nodeLength=node.textContent.length;if(!startNode&&charIndex+nodeLength>startOffset){startNode=node;startNodeOffset=startOffset-charIndex;}if(!endNode&&charIndex+nodeLength>=endOffset){endNode=node;endNodeOffset=endOffset-charIndex;break;}charIndex+=nodeLength;}if(!startNode||!endNode)return null;// Only apply if both start and end are in the same text node\n// (cross-node highlights are more complex and fragile)\nif(startNode!==endNode){// For cross-node, just highlight the first node's portion\nendNode=startNode;endNodeOffset=startNode.textContent.length;}const range=document.createRange();range.setStart(startNode,startNodeOffset);range.setEnd(endNode,endNodeOffset);return range;}","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","useHighlighter","allHighlights","setAllHighlights","toolbarState","setToolbarState","annotationPopup","setAnnotationPopup","passageRef","currentQuestionIdRef","setCurrentQuestion","questionId","current","getHighlights","handleMouseUp","e","setTimeout","selection","window","getSelection","isCollapsed","toString","trim","container","range","getRangeAt","contains","commonAncestorContainer","selectedText","length","rect","getBoundingClientRect","toolbarX","left","width","toolbarY","top","x","y","selectionText","cloneRange","applyHighlight","color","_window$getSelection","startOffset","endOffset","getTextOffsets","highlight","id","concat","Date","now","Math","random","substr","text","note","prev","_objectSpread","removeAllRanges","removeHighlight","highlightId","filter","h","updateNote","map","showAnnotation","closeAnnotation","handleClickOutside","target","closest","document","addEventListener","removeEventListener","treeWalker","createTreeWalker","NodeFilter","SHOW_TEXT","charIndex","foundStart","foundEnd","node","nextNode","startContainer","endContainer","textContent","applyHighlightsToDOM","highlights","onHighlightClick","sorted","sort","a","b","forEach","getTextRange","mark","createElement","className","dataset","stopPropagation","bottom","surroundContents","err","console","warn","startNode","startNodeOffset","endNode","endNodeOffset","nodeLength","createRange","setStart","setEnd"],"sources":["/sessions/adoring-focused-sagan/mnt/sat-mock-exam/src/hooks/useHighlighter.js"],"sourcesContent":["import { useState, useCallback, useRef, useEffect } from 'react';\n\n/**\n * Custom hook for managing text highlights and annotations in passages.\n * Stores highlights per question, persists across question navigation.\n *\n * Usage:\n *   const { highlights, toolbarState, ... } = useHighlighter(containerRef);\n */\nexport default function useHighlighter() {\n  // Map of questionId -> array of highlight objects\n  // Each highlight: { id, text, startOffset, endOffset, color, note }\n  const [allHighlights, setAllHighlights] = useState({});\n\n  // Toolbar state\n  const [toolbarState, setToolbarState] = useState(null); // { x, y, selectionText, range }\n\n  // Annotation popup state\n  const [annotationPopup, setAnnotationPopup] = useState(null); // { highlightId, questionId, x, y }\n\n  // Ref to the passage container DOM element\n  const passageRef = useRef(null);\n\n  // Current question ID for tracking\n  const currentQuestionIdRef = useRef(null);\n\n  /**\n   * Set the current question ID (call when question changes)\n   */\n  const setCurrentQuestion = useCallback((questionId) => {\n    currentQuestionIdRef.current = questionId;\n    setToolbarState(null);\n    setAnnotationPopup(null);\n  }, []);\n\n  /**\n   * Get highlights for a specific question\n   */\n  const getHighlights = useCallback((questionId) => {\n    return allHighlights[questionId] || [];\n  }, [allHighlights]);\n\n  /**\n   * Handle text selection (mouseup) in the passage\n   */\n  const handleMouseUp = useCallback((e) => {\n    // Small delay to let selection finalize\n    setTimeout(() => {\n      const selection = window.getSelection();\n      if (!selection || selection.isCollapsed || !selection.toString().trim()) {\n        // No selection or empty selection\n        setToolbarState(null);\n        return;\n      }\n\n      // Make sure selection is within the passage container\n      const container = passageRef.current;\n      if (!container) return;\n\n      const range = selection.getRangeAt(0);\n      if (!container.contains(range.commonAncestorContainer)) {\n        return;\n      }\n\n      const selectedText = selection.toString().trim();\n      if (selectedText.length < 2) return; // Ignore very short selections\n\n      // Position toolbar above the selection\n      const rect = range.getBoundingClientRect();\n      const toolbarX = rect.left + rect.width / 2;\n      const toolbarY = rect.top - 10;\n\n      setToolbarState({\n        x: toolbarX,\n        y: toolbarY,\n        selectionText: selectedText,\n        range: range.cloneRange(),\n      });\n    }, 10);\n  }, []);\n\n  /**\n   * Apply a highlight with the given color\n   */\n  const applyHighlight = useCallback((color) => {\n    if (!toolbarState || !toolbarState.range) return;\n\n    const questionId = currentQuestionIdRef.current;\n    if (!questionId) return;\n\n    const container = passageRef.current;\n    if (!container) return;\n\n    // Calculate text offset within the container\n    const { startOffset, endOffset } = getTextOffsets(container, toolbarState.range);\n\n    const highlight = {\n      id: `hl_${Date.now()}_${Math.random().toString(36).substr(2, 5)}`,\n      text: toolbarState.selectionText,\n      startOffset,\n      endOffset,\n      color,\n      note: '',\n    };\n\n    setAllHighlights(prev => ({\n      ...prev,\n      [questionId]: [...(prev[questionId] || []), highlight],\n    }));\n\n    // Clear selection\n    window.getSelection()?.removeAllRanges();\n    setToolbarState(null);\n  }, [toolbarState]);\n\n  /**\n   * Remove a highlight\n   */\n  const removeHighlight = useCallback((questionId, highlightId) => {\n    setAllHighlights(prev => ({\n      ...prev,\n      [questionId]: (prev[questionId] || []).filter(h => h.id !== highlightId),\n    }));\n    setAnnotationPopup(null);\n  }, []);\n\n  /**\n   * Update a highlight's note\n   */\n  const updateNote = useCallback((questionId, highlightId, note) => {\n    setAllHighlights(prev => ({\n      ...prev,\n      [questionId]: (prev[questionId] || []).map(h =>\n        h.id === highlightId ? { ...h, note } : h\n      ),\n    }));\n  }, []);\n\n  /**\n   * Show annotation popup for a highlight\n   */\n  const showAnnotation = useCallback((highlightId, questionId, x, y) => {\n    setAnnotationPopup({ highlightId, questionId, x, y });\n  }, []);\n\n  /**\n   * Close annotation popup\n   */\n  const closeAnnotation = useCallback(() => {\n    setAnnotationPopup(null);\n  }, []);\n\n  /**\n   * Dismiss toolbar when clicking outside\n   */\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      // Don't dismiss if clicking on the toolbar itself\n      if (e.target.closest('.highlight-toolbar') || e.target.closest('.annotation-popup')) {\n        return;\n      }\n      // Small delay to allow highlight click handlers to fire first\n      setTimeout(() => {\n        if (toolbarState) {\n          setToolbarState(null);\n        }\n      }, 100);\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [toolbarState]);\n\n  return {\n    passageRef,\n    allHighlights,\n    toolbarState,\n    annotationPopup,\n    setCurrentQuestion,\n    getHighlights,\n    handleMouseUp,\n    applyHighlight,\n    removeHighlight,\n    updateNote,\n    showAnnotation,\n    closeAnnotation,\n  };\n}\n\n/**\n * Get the text offset of a Range relative to a container element's textContent.\n * This gives us a position that's independent of the HTML structure.\n */\nfunction getTextOffsets(container, range) {\n  const treeWalker = document.createTreeWalker(\n    container,\n    NodeFilter.SHOW_TEXT,\n    null,\n    false\n  );\n\n  let charIndex = 0;\n  let startOffset = 0;\n  let endOffset = 0;\n  let foundStart = false;\n  let foundEnd = false;\n\n  let node;\n  while ((node = treeWalker.nextNode())) {\n    if (node === range.startContainer) {\n      startOffset = charIndex + range.startOffset;\n      foundStart = true;\n    }\n    if (node === range.endContainer) {\n      endOffset = charIndex + range.endOffset;\n      foundEnd = true;\n      break;\n    }\n    charIndex += node.textContent.length;\n  }\n\n  if (!foundStart) startOffset = 0;\n  if (!foundEnd) endOffset = startOffset;\n\n  return { startOffset, endOffset };\n}\n\n/**\n * Apply stored highlights to a DOM container.\n * Call this after the passage renders/re-renders.\n *\n * @param {HTMLElement} container - The passage DOM container\n * @param {Array} highlights - Array of highlight objects\n * @param {Function} onHighlightClick - Callback when a highlight is clicked\n */\nexport function applyHighlightsToDOM(container, highlights, onHighlightClick) {\n  if (!container || !highlights || highlights.length === 0) return;\n\n  // Sort highlights by startOffset descending so we apply from end to start\n  // This prevents offset shifts from affecting earlier highlights\n  const sorted = [...highlights].sort((a, b) => b.startOffset - a.startOffset);\n\n  sorted.forEach(highlight => {\n    try {\n      const range = getTextRange(container, highlight.startOffset, highlight.endOffset);\n      if (!range) return;\n\n      // Create the highlight mark element\n      const mark = document.createElement('mark');\n      mark.className = `passage-highlight${highlight.note ? ' has-note' : ''}`;\n      mark.dataset.color = highlight.color;\n      mark.dataset.highlightId = highlight.id;\n\n      // Handle click to show annotation\n      mark.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const rect = mark.getBoundingClientRect();\n        onHighlightClick(highlight.id, rect.left + rect.width / 2, rect.bottom + 5);\n      });\n\n      range.surroundContents(mark);\n    } catch (err) {\n      // If surroundContents fails (e.g., range spans multiple elements),\n      // fall back to a simpler approach\n      console.warn('Could not apply highlight:', err);\n    }\n  });\n}\n\n/**\n * Create a Range from text offsets within a container.\n */\nfunction getTextRange(container, startOffset, endOffset) {\n  const treeWalker = document.createTreeWalker(\n    container,\n    NodeFilter.SHOW_TEXT,\n    null,\n    false\n  );\n\n  let charIndex = 0;\n  let startNode = null;\n  let startNodeOffset = 0;\n  let endNode = null;\n  let endNodeOffset = 0;\n\n  let node;\n  while ((node = treeWalker.nextNode())) {\n    const nodeLength = node.textContent.length;\n\n    if (!startNode && charIndex + nodeLength > startOffset) {\n      startNode = node;\n      startNodeOffset = startOffset - charIndex;\n    }\n\n    if (!endNode && charIndex + nodeLength >= endOffset) {\n      endNode = node;\n      endNodeOffset = endOffset - charIndex;\n      break;\n    }\n\n    charIndex += nodeLength;\n  }\n\n  if (!startNode || !endNode) return null;\n\n  // Only apply if both start and end are in the same text node\n  // (cross-node highlights are more complex and fragile)\n  if (startNode !== endNode) {\n    // For cross-node, just highlight the first node's portion\n    endNode = startNode;\n    endNodeOffset = startNode.textContent.length;\n  }\n\n  const range = document.createRange();\n  range.setStart(startNode, startNodeOffset);\n  range.setEnd(endNode, endNodeOffset);\n  return range;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}